
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.7">
    
    
      
        <title>Grove ultrasonic ranger - DiffBot Differential Drive Mobile Robot</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.19753c6b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.196e0c26.min.css">
        
      
    
    
    
    <script src="../js/jquery-3.5.1.min.js"></script>
    <script src="../js/jquery.fitvids.js"></script>
    <script src="../js/config.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#grove-ultrasonic-ranger" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="DiffBot Differential Drive Mobile Robot" class="md-header-nav__button md-logo" aria-label="DiffBot Differential Drive Mobile Robot">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            DiffBot Differential Drive Mobile Robot
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Grove ultrasonic ranger
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/fjp/diffbot/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DiffBot Differential Drive Mobile Robot" class="md-nav__button md-logo" aria-label="DiffBot Differential Drive Mobile Robot">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    DiffBot Differential Drive Mobile Robot
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/fjp/diffbot/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../components/" class="md-nav__link">
      Components
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    <label class="md-nav__link" for="nav-3">
      Hardware and Theory
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Hardware and Theory" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Hardware and Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../theory/motion-and-odometry/" class="md-nav__link">
      Motion and Odometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../power-supply/" class="md-nav__link">
      Power Supply
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../laser-range-scanner/" class="md-nav__link">
      Laser Range Scanner
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    <label class="md-nav__link" for="nav-4">
      Processing Units
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Processing Units" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Processing Units
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ros-network-setup/" class="md-nav__link">
      Raspberry Pi Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../git-setup/" class="md-nav__link">
      Git Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ros-setup/" class="md-nav__link">
      ROS Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../teensy-mcu/" class="md-nav__link">
      Teensy MCU
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hardware-interfaces/" class="md-nav__link">
      Hardware Interfaces
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ros-network-setup/" class="md-nav__link">
      ROS Network Setup
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" >
    <label class="md-nav__link" for="nav-5">
      Packages
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Packages" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Packages
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../diffbot_robot/" class="md-nav__link">
      Robot Package
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../robot-description/" class="md-nav__link">
      Robot Description
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../diffbot_gazebo/" class="md-nav__link">
      Simulation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../diffbot_control/" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../diffbot_base/" class="md-nav__link">
      Base Hardware Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../diffbot_msgs/" class="md-nav__link">
      Messages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../grove_motor_driver/" class="md-nav__link">
      Motor Driver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DG01D-E-motor-with-encoder/" class="md-nav__link">
      Motor and Encoder
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../diffbot_navigation/" class="md-nav__link">
      Navigation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../diffbot_slam/" class="md-nav__link">
      SLAM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../diffbot_mbf/" class="md-nav__link">
      Move Base Flex
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../diffbot_bringup/" class="md-nav__link">
      Hardware Bringup
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#grove-ultrasonic-ranger" class="md-nav__link">
    Grove - Ultrasonic Ranger
  </a>
  
    <nav class="md-nav" aria-label="Grove - Ultrasonic Ranger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modified-groveultrasonicranger-library" class="md-nav__link">
    Modified GroveUltrasonicRanger Library
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ros-node-for-ultrasonic-ranger" class="md-nav__link">
    ROS Node for Ultrasonic Ranger
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#informational-distance-measurements" class="md-nav__link">
    Informational Distance Measurements
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/fjp/diffbot/blob/master/docs/grove_ultrasonic_ranger.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Grove ultrasonic ranger</h1>
                
                <h3 id="grove-ultrasonic-ranger">Grove - Ultrasonic Ranger</h3>
<p>To avoid obstacles the <a href="http://wiki.seeedstudio.com/Grove-Ultrasonic_Ranger/">Grove ultrasonic ranger</a> from Seeed Studio is used. We will create a ROS package with <a href="https://catkin-tools.readthedocs.io/en/latest/verbs/catkin_create.html#catkin-create-pkg"><code>catkin create pkg PKG_NAME [--catkin-deps [DEP [DEP ...]]]</code></a>:</p>
<pre><code class="language-bash">fjp@ubuntu:~/git/2wd-robot/ros/src$ catkin create pkg grove_ultrasonic_ranger --catkin-deps rospy roscpp sensor_msgs
Creating package &quot;grove_ultrasonic_ranger&quot; in &quot;/home/fjp/git/2wd-robot/ros/src&quot;...
Created file grove_ultrasonic_ranger/CMakeLists.txt
Created file grove_ultrasonic_ranger/package.xml
Created folder grove_ultrasonic_ranger/include/grove_ultrasonic_ranger
Created folder grove_ultrasonic_ranger/src
</code></pre>
<p>The package depends on the two ROS <a href="http://wiki.ros.org/Client%20Libraries">client libraries</a> <a href="http://wiki.ros.org/rospy"><code>rospy</code></a> and <a href="http://wiki.ros.org/roscpp"><code>roscpp</code></a>. 
To signalise the current distance to obstacles the <a href="http://docs.ros.org/melodic/api/sensor_msgs/html/msg/Range.html"><code>sensor_msgs/Range</code></a> message is used.</p>
<p>After connecting the signal pin of the sensor to <a href="https://pinout.xyz/pinout/pin11_gpio17#">(physical) GPIO 11</a> of the Raspberry Pi 4 B and power it with 5V and ground, we can test its functionality with the available 
python script <a href="https://github.com/Seeed-Studio/Grove-RaspberryPi/blob/master/Grove%20-%20Ultrasonic%20Ranger/ultrasonic.py"><code>ultrasonic.py</code></a> from Seed Studio.</p>
<p>The following shows the truncated output of the <code>ultrasonic.py</code> script when moving an obstacle in front of the sensor. We see that the distance value changes as expected. </p>
<pre><code class="language-bash">fjp@ubuntu:~/git/2wd-robot/ros/src/grove_ultrasonic_ranger/src$ sudo python ultrasonic.py
SeeedStudio Grove Ultrasonic get data and print
Ultrasonic Measurement
Distance : 2.0 CM
Ultrasonic Measurement
Distance : 2.1 CM
Ultrasonic Measurement
Distance : 2.0 CM
Ultrasonic Measurement
Distance : 3.5 CM
Ultrasonic Measurement
Distance : 3.5 CM
Ultrasonic Measurement
Distance : 2.4 CM
Ultrasonic Measurement
Distance : 12.9 CM
...
Ultrasonic Measurement
Distance : 45.8 CM
Ultrasonic Measurement
Distance : 510.7 CM
Ultrasonic Measurement
Distance : 510.7 CM
Ultrasonic Measurement
Distance : 45.7 CM
Ultrasonic Measurement
Distance : 161.8 CM
Ultrasonic Measurement
Distance : 26.9 CM
Ultrasonic Measurement
Distance : 18.3 CM
Ultrasonic Measurement
Distance : 160.9 CM
Ultrasonic Measurement
Distance : 158.3 CM
Ultrasonic Measurement
Distance : 159.4 CM
...
</code></pre>
<h4 id="modified-groveultrasonicranger-library">Modified GroveUltrasonicRanger Library</h4>
<p>To use the ultrasonic ranger as a ROS node it is convenient to wrap the sensor functionality in a class.
This provides an easy to extend interface for the ultrasonic ranger (<a href="https://en.wikipedia.org/wiki/Application_programming_interface">API</a>)
Therefore I copied the core functionality of the <a href="https://github.com/Seeed-Studio/Grove-RaspberryPi/blob/master/Grove%20-%20Ultrasonic%20Ranger/ultrasonic.py"><code>ultrasonic.py</code></a> script from Seeed Studio in a class named <a href="https://github.com/fjp/2wd-robot/blob/master/ros/src/grove_ultrasonic_ranger/src/grove_ultrasonic_ranger.py"><code>GroveUltrasonicRanger</code></a>.</p>
<p>Executing the <code>grove_ultrasonic_ranger.py</code> will result in the following output:</p>
<pre><code class="language-bash">fjp@ubuntu:~/git/2wd-robot/ros/src/grove_ultrasonic_ranger/src$ sudo python grove_ultrasonic_ranger.py 
SeeedStudio Grove Ultrasonic get data and print
Distance : 0.051 m
Distance : 0.069 m
Distance : 0.098 m
Distance : 0.131 m
Distance : 0.153 m
Distance : 0.172 m
Distance : 0.207 m
Distance : 0.210 m
Distance : 0.234 m
Distance : 0.256 m
GPIO.cleanup()
GPIO.cleanup() done
</code></pre>
<h4 id="ros-node-for-ultrasonic-ranger">ROS Node for Ultrasonic Ranger</h4>
<p>ROS provides the <a href="http://docs.ros.org/melodic/api/sensor_msgs/html/msg/Range.html">Range Message</a> in the <a href="https://wiki.ros.org/sensor_msgs">sensor_msgs header</a>. This message type can be used to write a wrapper that will act as a ROS node for the Grove ultrasonic sensor.</p>
<p>To design this node we will send out measurements periodically over a topic of type <code>sensor_msgs/Range</code>.
The code for this node is in <a href="https://github.com/fjp/2wd-robot/blob/master/ros/src/grove_ultrasonic_ranger/src/ranger.py"><code>ranger.py</code></a>.</p>
<p>After writing the node we need to build the packages in the workspace with <a href="https://catkin-tools.readthedocs.io/en/latest/verbs/catkin_build.html"><code>catkin build</code></a>.</p>
<pre><code class="language-bash">fjp@ubuntu:~/git/2wd-robot/ros$ catkin build
----------------------------------------------------------------
Profile:                     default
Extending:             [env] /opt/ros/melodic
Workspace:                   /home/fjp/git/2wd-robot/ros
----------------------------------------------------------------
Build Space:        [exists] /home/fjp/git/2wd-robot/ros/build
Devel Space:        [exists] /home/fjp/git/2wd-robot/ros/devel
Install Space:      [unused] /home/fjp/git/2wd-robot/ros/install
Log Space:         [missing] /home/fjp/git/2wd-robot/ros/logs
Source Space:       [exists] /home/fjp/git/2wd-robot/ros/src
DESTDIR:            [unused] None
----------------------------------------------------------------
Devel Space Layout:          linked
Install Space Layout:        None
----------------------------------------------------------------
Additional CMake Args:       None
Additional Make Args:        None
Additional catkin Make Args: None
Internal Make Job Server:    True
Cache Job Environments:      False
----------------------------------------------------------------
Whitelisted Packages:        None
Blacklisted Packages:        None
----------------------------------------------------------------
Workspace configuration appears valid.

NOTE: Forcing CMake to run for each package.
----------------------------------------------------------------
[build] Found '1' package in 0.0 seconds.                                                                                                
[build] Updating package table.                                                                                                           
Starting  &gt;&gt;&gt; catkin_tools_prebuild                                                                                                       
Finished  &lt;&lt;&lt; catkin_tools_prebuild                  [ 9.9 seconds ]                                                                                                                                                                                         
Starting  &gt;&gt;&gt; grove_ultrasonic_ranger                                                                                                                                                                                                                                                                                                                                                         
Finished  &lt;&lt;&lt; grove_ultrasonic_ranger                [ 12.0 seconds ]                                                                     
[build] Summary: All 2 packages succeeded!                                                                                                
[build]   Ignored:   None.                                                                                                                
[build]   Warnings:  None.                                                                                                                
[build]   Abandoned: None.                                                                                                                
[build]   Failed:    None.                                                                                                                
[build] Runtime: 21.9 seconds total.                                                                                                      
[build] Note: Workspace packages have changed, please re-source setup files to use them.
</code></pre>
<p>As the final note of the build output suggests, we have to <code>source</code> the <code>setup.bash</code> files in the <code>devel</code> space.</p>
<pre><code class="language-bash">fjp@ubuntu:~/git/2wd-robot/ros$ source devel/setup.bash
</code></pre>
<p>To make the <code>ranger</code> node executable we have to modify the <code>ranger.py</code> file:</p>
<pre><code class="language-bash">fjp@ubuntu:~/git/2wd-robot/ros/src/grove_ultrasonic_ranger/src$ sudo chmod a+x ranger.py
</code></pre>
<p>Then we can test the node using <code>rosrun</code>:</p>
<pre><code class="language-bash">fjp@ubuntu:~/git/2wd-robot/ros$ sudo su
[sudo] password for fjp:
root@ubuntu:/home/fjp/git/2wd-robot/ros# source devel/setup.bash 
root@ubuntu:/home/fjp/git/2wd-robot/ros# rosrun grove_ultrasonic_ranger ranger.py 
Distance : 1.617 m
Distance : 1.617 m
Distance : 1.617 m
Distance : 0.108 m
Distance : 0.092 m
Distance : 0.099 m
</code></pre>
<p>This lets the node publish range messages which we can capture in another terminal window using <code>rostopic</code>.
First we use <code>rostopic list</code> to find the name of the topic we are interested in:</p>
<pre><code class="language-bash">fjp@ubuntu:~/git/2wd-robot/ros$ rostopic list
/distance
/rosout
/rosout_agg
</code></pre>
<p>We named our topic <code>/distance</code> which we can use with the <code>rostopic echo</code> command to see the published messages:</p>
<pre><code class="language-bash">fjp@ubuntu:~/git/2wd-robot/ros$ rostopic echo /distance
header: 
  seq: 1
  stamp: 
    secs: 1576778377
    nsecs: 746809959
  frame_id: &quot;ranger_distance&quot;
radiation_type: 0
field_of_view: 0.261799007654
min_range: 0.019999999553
max_range: 3.5
range: 1.61674261093
---
header: 
  seq: 2
  stamp: 
    secs: 1576778378
    nsecs: 459048986
  frame_id: &quot;ranger_distance&quot;
radiation_type: 0
field_of_view: 0.261799007654
min_range: 0.019999999553
max_range: 3.5
range: 1.61261284351
---
header: 
  seq: 3
  stamp: 
    secs: 1576778379
    nsecs: 172172069
  frame_id: &quot;ranger_distance&quot;
radiation_type: 0
field_of_view: 0.261799007654
min_range: 0.019999999553
max_range: 3.5
range: 1.61657905579
---
header: 
  seq: 4
  stamp: 
    secs: 1576778379
    nsecs: 884002923
  frame_id: &quot;ranger_distance&quot;
radiation_type: 0
field_of_view: 0.261799007654
min_range: 0.019999999553
max_range: 3.5
range: 1.61277639866
---
header: 
  seq: 5
  stamp: 
    secs: 1576778380
    nsecs: 596549034
  frame_id: &quot;ranger_distance&quot;
radiation_type: 0
field_of_view: 0.261799007654
min_range: 0.019999999553
max_range: 3.5
range: 1.67693090439
---
</code></pre>
<h4 id="informational-distance-measurements">Informational Distance Measurements</h4>
<p>To provide additional information when an obstacle is too close or the robot has no obstacle in front of it we use
<a href="https://www.ros.org/reps/rep-0117.html">REP-117</a> as guideline.</p>
<p>To successfully implement this REP, checks for valid measurements should use floating-point standards and follow this form:</p>
<pre><code class="language-cpp">if(minimum_range &lt;= value &amp;&amp; value &lt;= maximum_range){  // Represents expected pre-REP logic and is the only necessary condition for most applications.
    // This is a valid measurement.
} else if( !isfinite(value) &amp;&amp; value &lt; 0){
    // Object too close to measure.
} else if( !isfinite(value) &amp;&amp; value &gt; 0){
    // No objects detected in range.
} else if( isnan(value) ){
    // This is an erroneous, invalid, or missing measurement.
} else {
    // The sensor reported these measurements as valid, but they are discarded per the limits defined by minimum_range and maximum_range.
}
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
    
      <script src="../assets/javascripts/vendor.0ac82a11.min.js"></script>
      <script src="../assets/javascripts/bundle.f81dfb4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
    <script>
        $(document).ready(function(){
            // Target your .container, .wrapper, .post, etc.
            $(".md-main").fitVids();
        });
    </script>
    <script data-ad-client="ca-pub-2214309606626131" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  </body>
</html>